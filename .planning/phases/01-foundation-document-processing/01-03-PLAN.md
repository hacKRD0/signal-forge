---
phase: 01-foundation-document-processing
type: execute
---

<objective>
Implement parsers for CSV and PPTX formats, plus create unified document parsing interface.

Purpose: Complete document parsing support for all required formats and provide a single interface for parsing any supported document type.
Output: CSV and PPTX parsers, unified DocumentParser class that auto-detects format and routes to appropriate parser.
</objective>

<execution_context>
@~/.claude/skills/create-plans/workflows/execute-phase.md
@~/.claude/skills/create-plans/templates/summary.md
</execution_context>

<context>
@.planning/BRIEF.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation-document-processing/01-02-SUMMARY.md
@src/parsers/docx_parser.py
@src/parsers/pdf_parser.py
@src/config.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add dependencies and implement CSV parser</name>
  <files>requirements.txt, src/parsers/csv_parser.py</files>
  <action>
Add to requirements.txt:
- pandas (for robust CSV handling)
- python-pptx (for PowerPoint parsing)

Install new dependencies: pip install -r requirements.txt

Create src/parsers/csv_parser.py:
- Function: parse_csv(file_path: str) -> str
- Use pandas.read_csv() to load CSV
- Convert DataFrame to readable string format using to_string() or to_markdown()
- Include column headers in output
- Handle errors: file not found, malformed CSV, encoding issues
- Try common encodings (utf-8, latin-1) if initial read fails
- Return formatted string representation
- Add docstring and logging

Avoid: Don't lose column structure in conversion. Don't fail on encoding issues without trying alternatives.
  </action>
  <verify>
- requirements.txt contains pandas and python-pptx
- src/parsers/csv_parser.py exists
- Imports successfully: python -c "from src.parsers.csv_parser import parse_csv"
- Function signature correct
  </verify>
  <done>CSV parser implemented with pandas and encoding error handling</done>
</task>

<task type="auto">
  <name>Task 2: Implement PPTX parser</name>
  <files>src/parsers/pptx_parser.py</files>
  <action>
Create src/parsers/pptx_parser.py:
- Function: parse_pptx(file_path: str) -> str
- Use python-pptx library (Presentation class)
- Iterate through all slides
- For each slide, extract text from all shapes (text_frame.text)
- Format as: "Slide N: [content]" with clear slide separators
- Extract notes if present (slide.notes_slide)
- Handle errors: file not found, corrupted PPTX, empty presentations
- Return extracted text as string
- Add docstring and logging

Avoid: Don't skip slides without shapes. Don't lose slide structure (keep slide numbers for context).
  </action>
  <verify>
- src/parsers/pptx_parser.py exists
- Imports successfully: python -c "from src.parsers.pptx_parser import parse_pptx"
- Function signature correct
  </verify>
  <done>PPTX parser implemented with slide-by-slide text extraction</done>
</task>

<task type="auto">
  <name>Task 3: Create unified DocumentParser interface</name>
  <files>src/parsers/document_parser.py</files>
  <action>
Create src/parsers/document_parser.py:
- Class: DocumentParser with method parse(file_path: str) -> str
- Auto-detect file format from extension (.docx, .pdf, .csv, .pptx)
- Route to appropriate parser based on extension
- Normalize extensions to lowercase for comparison
- Raise clear error for unsupported formats
- Return parsed text string
- Add logging for which parser was used
- Include docstring with supported formats list

Export convenience function: parse_document(file_path: str) -> str that instantiates DocumentParser and calls parse()

Update src/parsers/__init__.py to export: parse_document, DocumentParser

Avoid: Don't use MIME type detection (over-engineering, extension is sufficient). Don't silently fail on unsupported formats.
  </action>
  <verify>
- src/parsers/document_parser.py exists
- Imports: python -c "from src.parsers import parse_document, DocumentParser"
- All four parsers accessible through unified interface
- Unsupported extension raises clear error
  </verify>
  <done>Unified DocumentParser interface created with format auto-detection</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] requirements.txt contains pandas and python-pptx
- [ ] All four parsers exist (docx, pdf, csv, pptx)
- [ ] src/parsers/document_parser.py provides unified interface
- [ ] parse_document() function works for all supported formats
- [ ] Clear error for unsupported formats
- [ ] src/parsers/__init__.py exports main interface
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- All four document formats supported (DOCX, PDF, CSV, PPTX)
- Unified interface provides single entry point for any document type
- Phase 1 complete - ready for agent core development
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-document-processing/01-03-SUMMARY.md`:

# Phase 1 Plan 3: CSV/PPTX Parsers & Unified Interface Summary

**Completed all document parsers with unified interface**

## Accomplishments
- Implemented CSV parser with pandas (encoding-aware)
- Implemented PPTX parser with slide-by-slide extraction
- Created DocumentParser unified interface with auto-format detection
- Phase 1 complete: All document processing foundation ready

## Files Created/Modified
- `requirements.txt` - Added pandas, python-pptx
- `src/parsers/csv_parser.py` - CSV parsing
- `src/parsers/pptx_parser.py` - PowerPoint parsing
- `src/parsers/document_parser.py` - Unified interface
- `src/parsers/__init__.py` - Exports parse_document, DocumentParser

## Decisions Made
- Used pandas for CSV (robust handling of edge cases)
- Used python-pptx for PowerPoint (standard library)
- Extension-based format detection (simpler than MIME type sniffing)

## Issues Encountered
[Document any issues, or "None"]

## Next Step
Phase 1 complete. Ready for Phase 2: Agent Core
</output>
