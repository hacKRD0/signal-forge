---
phase: 01-foundation-document-processing
type: execute
---

<objective>
Implement document parsers for DOCX and PDF file formats.

Purpose: Enable the system to extract text content from Word documents and PDFs, which are key document types for business context.
Output: Working parsers that extract text from DOCX and PDF files with error handling.
</objective>

<execution_context>
@~/.claude/skills/create-plans/workflows/execute-phase.md
@~/.claude/skills/create-plans/templates/summary.md
</execution_context>

<context>
@.planning/BRIEF.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation-document-processing/01-01-SUMMARY.md
@src/config.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add document parsing dependencies</name>
  <files>requirements.txt</files>
  <action>
Add to requirements.txt:
- python-docx (for DOCX parsing - stable, well-maintained library)
- PyPDF2 (for PDF parsing - widely used, good for text extraction)

Install new dependencies:
- Activate virtual environment
- Run: pip install -r requirements.txt
- Verify installations: python -c "import docx; import PyPDF2"
  </action>
  <verify>
- requirements.txt contains python-docx and PyPDF2 with versions
- pip list shows both packages installed
- Import test succeeds without errors
  </verify>
  <done>Document parsing libraries installed and verified</done>
</task>

<task type="auto">
  <name>Task 2: Implement DOCX parser</name>
  <files>src/parsers/__init__.py, src/parsers/docx_parser.py</files>
  <action>
Create src/parsers/__init__.py (empty, makes it a package)

Create src/parsers/docx_parser.py:
- Function: parse_docx(file_path: str) -> str
- Use python-docx library to open document
- Extract all paragraph text, concatenate with newlines
- Extract text from tables (iterate rows/cells)
- Handle errors gracefully: file not found, corrupted files, empty documents
- Return extracted text as string
- Add docstring explaining usage and return format
- Include logging for parsing steps

Avoid: Don't try to preserve formatting (only text needed for AI context). Don't fail silently - raise descriptive exceptions.
  </action>
  <verify>
- src/parsers/docx_parser.py exists
- Imports successfully: python -c "from src.parsers.docx_parser import parse_docx"
- Function signature correct: accepts file_path, returns str
  </verify>
  <done>DOCX parser implemented with text extraction and error handling</done>
</task>

<task type="auto">
  <name>Task 3: Implement PDF parser</name>
  <files>src/parsers/pdf_parser.py</files>
  <action>
Create src/parsers/pdf_parser.py:
- Function: parse_pdf(file_path: str) -> str
- Use PyPDF2.PdfReader to open PDF
- Extract text from all pages using page.extract_text()
- Concatenate all page text with page separators
- Handle errors: file not found, encrypted PDFs, corrupted files, empty PDFs
- Return extracted text as string
- Add docstring explaining usage
- Include logging for parsing steps

Avoid: Don't use deprecated PyPDF2 classes (use PdfReader not PdfFileReader). Don't fail on encrypted PDFs - return meaningful error message. Don't attempt OCR (out of scope for now).
  </action>
  <verify>
- src/parsers/pdf_parser.py exists
- Imports successfully: python -c "from src.parsers.pdf_parser import parse_pdf"
- Function signature correct: accepts file_path, returns str
  </verify>
  <done>PDF parser implemented with text extraction and error handling</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] requirements.txt contains python-docx and PyPDF2
- [ ] src/parsers/ directory exists with __init__.py
- [ ] Both parser modules import without errors
- [ ] Both functions have correct signatures (file_path: str) -> str
- [ ] Error handling implemented for common failure cases
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- DOCX and PDF parsers functional and importable
- Error handling covers file not found, corrupted files, empty documents
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-document-processing/01-02-SUMMARY.md`:

# Phase 1 Plan 2: DOCX & PDF Parsers Summary

**Document parsers for Word and PDF files implemented**

## Accomplishments
- Added python-docx and PyPDF2 dependencies
- Implemented DOCX parser with paragraph and table extraction
- Implemented PDF parser with multi-page text extraction
- Error handling for corrupted/missing files

## Files Created/Modified
- `requirements.txt` - Added python-docx, PyPDF2
- `src/parsers/__init__.py` - Package initialization
- `src/parsers/docx_parser.py` - DOCX text extraction
- `src/parsers/pdf_parser.py` - PDF text extraction

## Decisions Made
- Used python-docx over alternatives (most stable for DOCX)
- Used PyPDF2 over alternatives (good balance of features and simplicity)
- No OCR for scanned PDFs (deferred to future enhancement)

## Issues Encountered
[Document any issues, or "None"]

## Next Step
Ready for 01-03-PLAN.md (Document parsers: CSV, PPTX + unified interface)
</output>
