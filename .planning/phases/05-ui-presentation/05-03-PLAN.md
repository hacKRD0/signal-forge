---
phase: 05-ui-presentation
type: execute
---

<objective>
Create results table display with all required fields and detailed view.

Purpose: Display discovered customers and partners in a comprehensive, user-friendly table with all required information.
Output: Results table showing company name, website, locations, size, match score, rationale, and sources.
</objective>

<execution_context>
@~/.claude/skills/create-plans/workflows/execute-phase.md
@~/.claude/skills/create-plans/templates/summary.md
@~/.claude/skills/create-plans/references/checkpoints.md
</execution_context>

<context>
@.planning/BRIEF.md
@.planning/ROADMAP.md
@.planning/phases/05-ui-presentation/05-02-SUMMARY.md
@app.py
@src/models/discovery_results.py
@src/models/match_score.py
@src/models/rationale.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create results table component</name>
  <files>src/ui/results_display.py</files>
  <action>
Create src/ui/results_display.py:
- Function: render_results_table(results: DiscoveryResult, entity_type: str)
  - Display title: "Discovered {entity_type}s ({N} results)"
  - Create pandas DataFrame from results for table display
  - Columns: Rank, Company Name, Match Score, Size, Locations, Website
  - Format match score with color coding:
    - Green: >= 80 (Strong Match)
    - Yellow: 60-79 (Good Match)
    - Gray: < 60 (Fair Match)
  - Make website clickable (use st.link_button or markdown links)
  - Add sort/filter options (by score, by location)
  - Show avg_score summary at top
- Function: render_company_detail(company: CompanyInfo)
  - Expandable detail view (st.expander)
  - Show all fields: name, website, locations, size, description
  - Show match score breakdown (all components)
  - Show rationale: summary, key strengths, fit explanation, potential concerns
  - Show sources as clickable links
  - Format nicely with sections and headings

Avoid: Don't overwhelm with too much info in table (details in expandable). Don't lose data (show all in detail view).
  </action>
  <verify>
- src/ui/results_display.py exists
- render_results_table function creates table display
- render_company_detail shows comprehensive information
- Imports work: python -c "from src.ui.results_display import *"
  </verify>
  <done>Results table and detail view components created</done>
</task>

<task type="auto">
  <name>Task 2: Integrate results display into app</name>
  <files>app.py</files>
  <action>
Update app.py:
- Import render_results_table, render_company_detail
- After discovery section: add results display section
- Create two tabs: "Customers" and "Partners" (st.tabs)
- Customers tab:
  - If customer results in session state: render_results_table()
  - For each company: render_company_detail() in expander
  - Else: show "No customer results yet"
- Partners tab:
  - If partner results in session state: render_results_table()
  - For each company: render_company_detail() in expander
  - Else: show "No partner results yet"
- Add download buttons:
  - CSV export of results table
  - JSON export of full results (including scores and rationales)

Avoid: Don't reload on every interaction (use session state effectively). Don't make too many API calls.
  </action>
  <verify>
- app.py shows results in tabs
- Table displays correctly
- Detail view expanders work
- Download buttons functional
- streamlit run app.py shows complete flow: upload → process → discover → view results
  </verify>
  <done>Results display integrated into main app with tabs and downloads</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete Streamlit UI with file upload, discovery, and results display</what-built>
  <how-to-verify>
1. Run: streamlit run app.py
2. Browser opens to http://localhost:8501
3. Test file upload:
   - Upload sample documents (create test DOCX/PDF if needed)
   - Click "Process Documents"
   - Verify business context summary appears
4. Test discovery:
   - Select "Customer" or "Partner"
   - Optionally add filters
   - Click "Generate"
   - Wait for discovery (30-60 seconds)
   - Verify results table appears
5. Test results display:
   - Check table shows: company name, score, size, locations, website
   - Expand company details
   - Verify rationale, sources, score breakdown visible
   - Click website links (open in new tab)
6. Test tabs:
   - Switch between Customers and Partners tabs
   - Verify both can hold separate results
7. Test downloads:
   - Click CSV download button
   - Click JSON download button
   - Verify files download correctly
8. Check for errors in console or UI
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe any UI/UX issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Results table displays all required fields
- [ ] Detail view shows comprehensive company information
- [ ] Match scores color-coded for quick assessment
- [ ] Sources displayed as clickable links
- [ ] Download functionality for CSV and JSON
- [ ] Tabs separate customers and partners
- [ ] Phase 5 complete - UI fully functional
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Results table user-friendly and comprehensive
- Detail view provides all information needed
- Human verification confirms UI works correctly
- Phase 5 complete - ready for tracing and documentation
</success_criteria>

<output>
After completion, create `.planning/phases/05-ui-presentation/05-03-SUMMARY.md`:

# Phase 5 Plan 3: Results Display Summary

**Results table with comprehensive company information**

## Accomplishments
- Created results table component with all required fields
- Implemented detailed company view with expandable sections
- Integrated results display into app with tabs
- Color-coded match scores for quick assessment
- Download functionality (CSV and JSON)
- Human verification completed for UI/UX
- Phase 5 complete: Full Streamlit UI operational

## Files Created/Modified
- `src/ui/results_display.py` - Results table and detail view
- `app.py` - Results display integration with tabs

## Decisions Made
- Tabs separate customers and partners (clean organization)
- Table shows summary, expanders show details (progressive disclosure)
- Color-coded scores (green/yellow/gray for quick scanning)
- Both CSV and JSON exports (different use cases)
- Clickable website links and sources

## Issues Encountered
[If any UI issues found during verification, document here]

## Next Step
Phase 5 complete. Ready for Phase 6: Tracing & Documentation
</output>
