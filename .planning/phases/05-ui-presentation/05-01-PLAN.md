---
phase: 05-ui-presentation
type: execute
---

<objective>
Create Streamlit application structure and file upload component.

Purpose: Build the foundation of the Streamlit UI with file upload functionality for business context documents.
Output: Working Streamlit app with multi-file upload and document processing.
</objective>

<execution_context>
@~/.claude/skills/create-plans/workflows/execute-phase.md
@~/.claude/skills/create-plans/templates/summary.md
</execution_context>

<context>
@.planning/BRIEF.md
@.planning/ROADMAP.md
@src/parsers/document_parser.py
@src/agent/context_extractor.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Streamlit dependency and create app structure</name>
  <files>requirements.txt, app.py, src/ui/__init__.py, src/ui/components.py</files>
  <action>
Add to requirements.txt:
- streamlit (for web UI)

Install: pip install -r requirements.txt

Create app.py (main Streamlit application):
- Import streamlit
- Set page config: title="Customer & Partner Discovery", layout="wide"
- Add main title and description
- Create placeholder sections for: file upload, query input, results
- Add st.sidebar for configuration/info

Create src/ui/__init__.py (package)

Create src/ui/components.py:
- Function: render_header() - app title and description
- Function: render_file_uploader() -> list[UploadedFile] - multi-file upload widget
  - Accept DOCX, PDF, CSV, PPTX
  - Return uploaded files list
- Add docstrings

Avoid: Don't build full UI yet - just structure and file upload. Don't add styling complexity.
  </action>
  <verify>
- requirements.txt contains streamlit
- app.py exists and runs: streamlit run app.py (opens in browser)
- src/ui/components.py exists
- File uploader widget visible in app
  </verify>
  <done>Streamlit app structure created with file upload component</done>
</task>

<task type="auto">
  <name>Task 2: Implement document processing integration</name>
  <files>app.py, src/ui/document_processor.py</files>
  <action>
Create src/ui/document_processor.py:
- Function: process_uploaded_files(uploaded_files: list) -> BusinessContext
  - Save uploaded files to temporary directory
  - Get file paths
  - Use parse_document() to extract text from each
  - Use ContextExtractor to extract business context
  - Clean up temporary files
  - Return BusinessContext
  - Add error handling for parsing failures
  - Show progress with st.progress() during processing

Update app.py:
- Import document_processor, ContextExtractor
- Add session state for: uploaded_context (BusinessContext or None)
- After file upload: button "Process Documents"
- On click: process files with progress indicator
  - Call process_uploaded_files()
  - Store result in st.session_state.uploaded_context
  - Show success message with extracted info summary
- Display extracted context in expandable section

Avoid: Don't process files on every rerun (use session state). Don't block UI during processing (show progress).
  </action>
  <verify>
- src/ui/document_processor.py exists
- app.py processes uploaded files on button click
- Extracted context stored in session state
- Progress indicator shows during processing
- streamlit run app.py works without errors
  </verify>
  <done>Document processing integrated with file upload</done>
</task>

<task type="auto">
  <name>Task 3: Add context display and session management</name>
  <files>app.py, src/ui/components.py</files>
  <action>
Update src/ui/components.py:
- Function: render_context_summary(context: BusinessContext) - Display extracted business context
  - Show in st.expander("Business Context Summary")
  - Display: company name, industry, products, target market, geography
  - Format nicely with st.markdown
  - Allow user to edit/refine if needed

Update app.py:
- Add session state management:
  - st.session_state.uploaded_context (BusinessContext)
  - st.session_state.discovery_results_customers (list or None)
  - st.session_state.discovery_results_partners (list or None)
- After processing: show context summary with render_context_summary()
- Add "Clear All" button in sidebar to reset session state

Avoid: Don't lose session state on rerun. Don't make editing too complex (show context, allow manual JSON edit if needed).
  </action>
  <verify>
- Context summary displays after processing
- Session state persists across reruns
- Clear button resets state
- streamlit run app.py shows full upload and processing flow
  </verify>
  <done>Context display and session management implemented</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Streamlit app runs without errors
- [ ] File upload accepts DOCX, PDF, CSV, PPTX
- [ ] Document processing extracts business context
- [ ] Context summary displays extracted information
- [ ] Session state manages uploaded context
- [ ] Ready for query input component
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Streamlit app structure established
- File upload and processing functional
- User can upload documents and see extracted context
</success_criteria>

<output>
After completion, create `.planning/phases/05-ui-presentation/05-01-SUMMARY.md`:

# Phase 5 Plan 1: Streamlit App & File Upload Summary

**Streamlit application with file upload and context extraction**

## Accomplishments
- Added Streamlit dependency
- Created app structure (app.py, ui components)
- Implemented multi-file upload widget
- Integrated document processing pipeline
- Session state management for context persistence
- Context summary display

## Files Created/Modified
- `requirements.txt` - Added streamlit
- `app.py` - Main Streamlit application
- `src/ui/__init__.py` - UI package
- `src/ui/components.py` - UI component functions
- `src/ui/document_processor.py` - Document processing integration

## Decisions Made
- Streamlit for UI (fast prototyping, Python-native)
- Temporary file handling for uploads
- Session state for context persistence
- Progress indicators during processing

## Issues Encountered
[Document any issues, or "None"]

## Next Step
Ready for 05-02-PLAN.md (Query input and filters)
</output>
